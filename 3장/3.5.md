## 3.5 여러 개의 통합 문서 처리하기
`glob`, `os` 모듈을 이용해 특정 경로의 여러 통합 문서를 처리한다

### 3.5.1 통합 문서의 개수 및 각 통합 문서의 행과 열 개수 세기
```python
import glob
import os
from xlrd import open_workbook

input_directory = "./"

workbook_counter = 0
for input_file in glob.glob(os.path.join(input_directory, '*.xlsx')):
    workbook = open_workbook(input_file)
    print('Workbook: {}'.format(os.path.basename(input_file)))
    print('number of worksheets: {}'.format(workbook.nsheets))
    for worksheet in workbook.sheets():
        print('Worksheet name:', worksheet.name, '\tRows', worksheet.nrows,\
         '\tColumns:', worksheet.ncols)
    workbook_counter += 1
    print('\n')
print('Number of Excel workbooks: {}'.format(workbook_counter))
```
>Workbook: sales_2013.xlsx\
number of worksheets: 3\
Worksheet name: january_2013 	Rows 7 	Columns: 5\
Worksheet name: february_2013 	Rows 7 	Columns: 5\
Worksheet name: march_2013 	Rows 7 	Columns: 5\
\
\
Workbook: sales_2014.xlsx\
number of worksheets: 3\
Worksheet name: january_2014 	Rows 7 	Columns: 5\
Worksheet name: february_2014 	Rows 7 	Columns: 5\
Worksheet name: march_2014 	Rows 7 	Columns: 5\
\
\
Workbook: sales_2015.xlsx\
number of worksheets: 3\
Worksheet name: january_2015 	Rows 7 	Columns: 5\
Worksheet name: february_2015 	Rows 7 	Columns: 5\
Worksheet name: march_2015 	Rows 7 	Columns: 5\
\
\
Number of Excel workbooks: 3

### 3.5.2 여러 개의 통합문서 합치기
#### 기본 파이썬
```python
import glob
import os
from datetime import date
from xlrd import open_workbook, xldate_as_tuple
from xlwt import Workbook

input_folder = "./"
output_file = "12output.xls"

output_workbook = Workbook()
output_worksheet = output_workbook.add_sheet('all_data_all_workbooks')

data = []
first_worksheet = True

for input_file in glob.glob(os.path.join(input_folder, '*.xlsx')):
    print(os.path.basename(input_file))
```
>input_file의 이름을 출력한다\
sales_2013.xlsx\
sales_2014.xlsx\
sales_2015.xlsx

```python
import glob
import os
from datetime import date
from xlrd import open_workbook, xldate_as_tuple
from xlwt import Workbook

input_folder = "./"
output_file = "12output.xls"

output_workbook = Workbook()
output_worksheet = output_workbook.add_sheet('all_data_all_workbooks')

data = []
first_worksheet = True

for input_file in glob.glob(os.path.join(input_folder, '*.xlsx')):
    print(os.path.basename(input_file))
    with open_workbook(input_file) as workbook:
        for worksheet in workbook.sheets():
            if first_worksheet:
                header_row = worksheet.row_values(0) #0번째 행의 데이터를 헤더로 저장
                data.append(header_row)
                first_worksheet = False
                print(data)
            for row_index in range(1,worksheet.nrows):
                row_list = []
                for column_index in range(worksheet.ncols):
                    cell_value = worksheet.cell_value(row_index, column_index) #행, 열 위치에 따라 cell 값 지정
                    cell_type = worksheet.cell_type(row_index, column_index)
                    if cell_type == 3:
                        date_cell = xldate_as_tuple(cell_value, workbook.datemode)
                        date_cell = date(*date_cell[0:3]).strftime('%m/%d/%Y')
                        row_list.append(date_cell)
                    else:
                        row_list.append(cell_value)
                data.append(row_list)
                print(row_list)
```
> sales_2013.xlsx
[['Customer ID', 'Customer Name', 'Invoice Number', 'Sale Amount', 'Purchase Date']]
[1234.0, 'John Smith', '100-0002', 1200.0, '01/01/2013']
[2345.0, 'Mary Harrison', '100-0003', 1425.0, '01/06/2013']
[3456.0, 'Lucy Gomez', '100-0004', 1390.0, '01/11/2013']
[4567.0, 'Rupert Jones', '100-0005', 1257.0, '01/18/2013']
[5678.0, 'Jenny Walters', '100-0006', 1725.0, '01/24/2013']
[6789.0, 'Samantha Donaldson', '100-0007', 1995.0, '01/31/2013']
[9876.0, 'Daniel Farber', '100-0008', 1115.0, '02/02/2013']
[8765.0, 'Laney Stone', '100-0009', 1367.0, '02/08/2013']
[7654.0, 'Roger Lipney', '100-0010', 2135.0, '02/15/2013']
[6543.0, 'Thomas Haines', '100-0011', 1346.0, '02/17/2013']
[5432.0, 'Anushka Vaz', '100-0012', 1560.0, '02/21/2013']
[4321.0, 'Harriet Cooper', '100-0013', 1852.0, '02/25/2013']
[1234.0, 'John Smith', '100-0014', 1350.0, '03/04/2013']
[8765.0, 'Tony Song', '100-0015', 1167.0, '03/08/2013']
[2345.0, 'Mary Harrison', '100-0016', 1789.0, '03/17/2013']
[6543.0, 'Rachel Paz', '100-0017', 2042.0, '03/22/2013']
[3456.0, 'Lucy Gomez', '100-0018', 1511.0, '03/28/2013']
[4321.0, 'Susan Wallace', '100-0019', 2280.0, '03/30/2013']
sales_2014.xlsx
[1234.0, 'John Smith', '100-0002', 345.0, '01/01/2014']
[2345.0, 'Mary Harrison', '100-0003', 67576.0, '01/06/2014']
[3456.0, 'Lucy Gomez', '100-0004', 45.0, '01/11/2014']
[4567.0, 'Rupert Jones', '100-0005', 67876.0, '01/18/2014']
[5678.0, 'Jenny Walters', '100-0006', 124321.0, '01/24/2014']
[6789.0, 'Samantha Donaldson', '100-0007', 58.0, '01/31/2014']
[9876.0, 'Daniel Farber', '100-0008', 24.0, '02/02/2014']
[8765.0, 'Laney Stone', '100-0009', 45654.0, '02/08/2014']
[7654.0, 'Roger Lipney', '100-0010', 789.0, '02/15/2014']
[6543.0, 'Thomas Haines', '100-0011', 214.0, '02/17/2014']
[5432.0, 'Anushka Vaz', '100-0012', 432.0, '02/21/2014']
[4321.0, 'Harriet Cooper', '100-0013', 56543.0, '02/25/2014']
[1234.0, 'John Smith', '100-0014', 123.0, '03/04/2014']
[8765.0, 'Tony Song', '100-0015', 43453.0, '03/08/2014']
[2345.0, 'Mary Harrison', '100-0016', 56756.0, '03/17/2014']
[6543.0, 'Rachel Paz', '100-0017', 654.0, '03/22/2014']
[3456.0, 'Lucy Gomez', '100-0018', 434.0, '03/28/2014']
[4321.0, 'Susan Wallace', '100-0019', 89.0, '03/30/2014']
sales_2015.xlsx
[1234.0, 'John Smith', '100-0002', 123.0, '01/01/2015']
[2345.0, 'Mary Harrison', '100-0003', 543.0, '01/06/2015']
[3456.0, 'Lucy Gomez', '100-0004', 567.0, '01/11/2015']
[4567.0, 'Rupert Jones', '100-0005', 978.0, '01/18/2015']
[5678.0, 'Jenny Walters', '100-0006', 345.0, '01/24/2015']
[6789.0, 'Samantha Donaldson', '100-0007', 645.0, '01/31/2015']
[9876.0, 'Daniel Farber', '100-0008', 11243.0, '02/02/2015']
[8765.0, 'Laney Stone', '100-0009', 34665.0, '02/08/2015']
[7654.0, 'Roger Lipney', '100-0010', 86.0, '02/15/2015']
[6543.0, 'Thomas Haines', '100-0011', 2353.0, '02/17/2015']
[5432.0, 'Anushka Vaz', '100-0012', 5687.0, '02/21/2015']
[4321.0, 'Harriet Cooper', '100-0013', 973.0, '02/25/2015']
[1234.0, 'John Smith', '100-0014', 123.0, '03/04/2015']
[8765.0, 'Tony Song', '100-0015', 234435.0, '03/08/2015']
[2345.0, 'Mary Harrison', '100-0016', 456.0, '03/17/2015']
[6543.0, 'Rachel Paz', '100-0017', 6476.0, '03/22/2015']
[3456.0, 'Lucy Gomez', '100-0018', 234.0, '03/28/2015']
[4321.0, 'Susan Wallace', '100-0019', 4321.0, '03/30/2015']

- 
